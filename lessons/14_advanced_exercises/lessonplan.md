# Advanced Exercises

You're completely on your own for this section! These exercises come from the
challenges I wrote for Gryphon CTF, a capture the flag competition run by the
students at Singapore Polytechnic for their peers.

## Exercise 14.1: Drag Race

```
This bad binary is all T. All Shade.

nc localhost 1345
```

The binary can be found [here][1]. Try to do it without access to the source
code but if you need it, it can be found [here][2].

## Exercise 14.2: Black Beauty

```
With a bestselling book under her belt and over fifty million copies sold, Anna
Sewell has decided to go into the stock market. Please help her figure out her
stock market ticker.

nc localhost 1350
```

[Binary][3].

[Source code][4], if you need it.

## Exercise 14.3: Mystery Jukebox

```
Listen to some Postmodern Jukebox (https://youtu.be/NTmk0Pqk6hs) while playing
with this Mystery Jukebox program!

nc play.spgame.site 1343
```

[Binary and Libc][5].

[Source code][6], if you need it.

## Excercise 14.4: CVE-2015-7547 - glibc getaddrinfo stack-based buffer overflow

A real stack-based buffer overflow vulnerability in glibc 2.9-2.21. You can read up more on the vulnerability [here][7].

A crashing PoC is also provided at [https://github.com/fjserna/CVE-2015-7547](https://github.com/fjserna/CVE-2015-7547). 

The PoC emulates a DNS server and in order to test if your system is vulnerable, you can follow the steps below:

1. Edit /etc/resolv.conf to change the nameserver to 127.0.0.1.
2. Run the crashing PoC python script.
3. Do a `curl foo.bar.google.com`.
4. You should notice that the machine curling would crash (if its running a vulnerable glibc version).

**Hint: You might want to attempt exploiting with ASLR disabled first.**


[1]: ./challenges/dragrace/distrib/dragrace_981dac47f4cb1881baf246df10e73536
[2]: ./services/dragrace/dragrace.c
[3]: ./challenges/black_beauty/distrib/blackbeauty_6b350b986168bfcf6a85fecc377552dd
[4]: ./services/black_beauty/blackbeauty.c
[5]: ./challenges/mystery_jukebox/distrib/jukebox_a761352ac202e55d441e7e807d89962b.tar.gz
[6]: ./services/mystery_jukebox/jukebox.c
[7]: https://security.googleblog.com/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html
